<!--quiz.html-->
<!DOCTYPE html>
{% set debug= True %}
<html lang="{{ request.state.lang }}" dir="{{ 'rtl' if request.state.lang.startswith('ar') else 'ltr' }}">
<head>
  <meta charset="UTF-8">
  <title>Quiz</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="icon" href="{{ url_for('static', path='favicon.ico') }}">
    <script>   // This will be filled by Jinja as JSON
        const commandsInfo = {{ commands_dict_json | safe }};
        const categoryCommands = {{ category_commands_json | safe }};
</script>
</head>
<body class="flex flex-col min-h-screen">
<!-- header -->
<header class="bg-blue-600 text-white p-4 shadow">
  <div class="max-w-5xl mx-auto flex justify-between items-center">
    <h1 class="text-xl font-bold">STRM Quiz Generator</h1>
    <a href="https://github.com/linuxscout/strm-tests" target="_blank"
       class="flex items-center gap-2 text-sm hover:underline">
      <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
        <path d="M12 .5C5.65.5.5 5.65.5 12c0 5.1 3.3 9.4 7.9 10.9.6.1.8-.3.8-.6v-2c-3.2.7-3.9-1.5-3.9-1.5-.5-1.2-1.2-1.6-1.2-1.6-1-.7.1-.7.1-.7 1.1.1 1.7 1.1 1.7 1.1 1 .1.5 1.8 2.7 2.2.1-.7.4-1.2.7-1.5-2.6-.3-5.4-1.3-5.4-5.9 0-1.3.5-2.4 1.2-3.2-.1-.3-.5-1.6.1-3.3 0 0 1-.3 3.3 1.2a11.4 11.4 0 0 1 6 0c2.3-1.5 3.3-1.2 3.3-1.2.6 1.7.2 3 .1 3.3.8.8 1.2 1.9 1.2 3.2 0 4.7-2.8 5.6-5.4 5.9.4.3.8 1 .8 2v3c0 .3.2.7.8.6A11.5 11.5 0 0 0 23.5 12C23.5 5.65 18.35.5 12 .5Z"/>
      </svg>
      GitHub
    </a>
  </div>
</header>
 <!-- main content -->
  <main class="flex-1 max-w-5xl mx-auto p-6">

  <h2 class="text-2xl font-bold mb-6">{{tr("Select Command to Generate a Quiz", )}}</h2>

  <div class="flex flex-col md:flex-row gap-6">
    <!-- Left: form -->
    <div class="flex-1 bg-white rounded-2xl shadow p-6">
      <form id="quizForm" class="space-y-4">
        <!-- Category -->
        <div>
          <label for="selectcategory" class="block text-sm font-medium mb-1">{{tr("Category",)}}</label>
          <select id="selectcategory" name="category" onchange="updateCommands()"
            class="w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500">
            <option value="random" selected>{{tr("Random Category", )}}</option>
            {% for cat_key, cat_value in categories_dict.items() %}
              <option value="{{cat_key}}">{{cat_value.short}}</option>
            {% endfor %}
          </select>
          <p class="text-xs text-gray-500 mt-1">{{tr("Choose a category to filter commands.", )}}</p>
        </div>
        <!-- Command -->
        <div>
          <label for="selectcommand" class="block text-sm font-medium mb-1">{{tr("Command", )}}</label>
          <select id="selectcommand" name="command"
            class="w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500">
            <option value="random" selected>{{tr("Random Question")}}</option>
          </select>
          <p id="commandHint" class="text-xs text-gray-500 mt-1"></p>
        </div>

        <!-- Output format -->
        <div>
          <label for="selectformat" class="block text-sm font-medium mb-1">{{tr("Format", )}}</label>
          <select id="selectformat" name="outformat"
            class="w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500">
            <option value="html" selected>HTML</option>
            {% for fmt_key, fmt_value in format_dict.items() %}
            {%if fmt_key.lower() !="html"%}
              <option value="{{fmt_key}}" >{{fmt_value}}</option>
            {%endif%}
            {% endfor %}
          </select>
        </div>

        <!-- Quiz -->
        <div>
          <label for="selectquiz" class="block text-sm font-medium mb-1">{{tr("Quiz", )}}</label>
          <select id="selectquiz" name="quiz_id"
            class="w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500">
            <option value="" selected>{{tr("No predefined quiz selected", )}}</option>
            {% for qi in quiz_id_list %}
              <option value="{{qi}}">{{qi}}</option>
            {% endfor %}
          </select>
        </div>

        <!-- Args (dynamic) -->
        <div id="argsForm" class="space-y-2"></div>

        <!-- Random checkbox -->
        <div class="flex items-center gap-2">
          <input name="random" id="random" type="checkbox"
            class="rounded border-gray-300 text-blue-600 focus:ring-blue-500"/>
          <label for="random" class="text-sm">{{tr("Random data for question", )}}</label>
        </div>
        <!-- Download checkbox -->
        <div class="flex items-center gap-2">
          <input name="download" id="download" type="checkbox"
            class="rounded border-gray-300 text-blue-600 focus:ring-blue-500"/>
          <label for="download" class="text-sm">{{tr("Download results")}}</label>
        </div>
        <!-- Buttons -->
        <div class="flex gap-4">
          <button type="submit"
            class="bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700">{{tr("Submit", )}}</button>
          <button type="button" onclick="resetForm()"
            class="bg-gray-200 text-gray-800 px-4 py-2 rounded-lg shadow hover:bg-gray-300">{{tr("Reset", )}}</button>
        </div>
      </form>
    </div>

    <!-- Right: preview panel -->
    <div class="flex-1 bg-white rounded-2xl shadow p-6">
      <h3 class="text-lg font-semibold mb-4">{{tr("Preview", )}}</h3>
      <div id="exampleDiv" class="p-4 border border-dashed border-gray-300 rounded-lg mb-4">
        {{tr("Select a command to see an example question here.", )}}
      </div>
      <div id="previewPanel" class="text-sm text-gray-600">
        {{tr("Select options to preview question...", )}}
      </div>
    </div>
  </div>

  <!-- Spinner -->
  <div id="spinner" class="hidden text-center mt-6">
    <div class="animate-spin h-8 w-8 border-4 border-gray-200 border-t-blue-600 rounded-full mx-auto"></div>
    <p class="text-sm text-gray-500 mt-2">{{tr("Generating quiz...", )}}</p>
  </div>

  <!-- Result -->
  <div id="resultDiv" class="mt-6 bg-white rounded-2xl shadow p-6 border">
    <pre id="resultPre" class="text-sm text-gray-700 ">{{tr("Result will appear here...", )}}</pre>
  </div>



  </main>

<footer class="bg-gray-100 border-t mt-8 p-4">
  <div class="max-w-5xl mx-auto text-center text-sm text-gray-600">
    © 2025 STRM Quiz Generator — مولد اختبارات مادة بنية الآلة
    <a href="https://github.com/linuxscout/strm-tests" target="_blank" class="text-blue-600 hover:underline">View on GitHub</a>
  </div>
</footer>
  <!-- Keep your existing <script> logic unchanged -->
<script src="{{ url_for('static', path='webui.js') }}"></script>
</body>
</html>
